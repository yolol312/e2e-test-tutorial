# 2. 테스트 환경 설정 (Playwright) — 5분 버전

이 단계의 목표는 **“E2E 테스트를 실행할 수 있는 환경”**을 5분 안에 만드는 것입니다.  
다음 단계(기본 테스트 적용)부터는 실제로 `e2e/`에 테스트를 추가합니다.

---

## 준비물

- **Node.js + npm** (권장: LTS)
- 터미널(iTerm/Terminal/Cursor Terminal)
- 이 레포(`e2e-test-tutorial`) 클론/다운로드 완료

---

## 0) 이 프로젝트의 실행 구조(30초만 이해)

- 프론트: **Vite dev server** → `http://localhost:5173`
- API: **json-server** → `http://localhost:3000`
- 개발 서버 실행: `npm run dev` (프론트+API를 함께 띄움)
- Playwright는 `playwright.config.ts`에서 **baseURL=5173**, **webServer= npm run dev**로 연결됩니다.

---

## 1) Playwright 설치 (1분)

```bash
npm init playwright@latest

✔ Where to put your end-to-end tests? · e2e
✔ Add a GitHub Actions workflow? (Y/n) · true
✔ Install Playwright browsers (can be done manually via 'npx playwright install')? (Y/n) · true
```

> **팁**: CI(리눅스)에서는 보통 `npx playwright install --with-deps`를 씁니다. (6단계 GitHub Actions에서 적용)

---

## 2) 프로젝트 기본 구성 만들기 (2분)

### 2-1. `package.json` 스크립트 추가

- `e2e`: headless 실행
- `e2e:ui`: UI 모드(디버깅/학습에 최고)

예시:

```json
{
  "scripts": {
    "dev": "concurrently \"npm run api\" \"vite\"",
    "api": "json-server --watch db.json --port 3000",
    "e2e": "playwright test",
    "e2e:ui": "playwright test --ui"
  }
}
```

### 2-2. `playwright.config.ts` 작성(또는 생성)

핵심은 2가지입니다.

- **baseURL**: 앱 주소(여기서는 `http://localhost:5173`)
- **webServer**: 테스트 전에 앱을 자동으로 띄우는 명령(여기서는 `npm run dev`)

이 프로젝트 예시:

```ts
import { defineConfig } from "@playwright/test";

export default defineConfig({
  testDir: "./e2e",
  use: {
    baseURL: "http://localhost:5173",
  },
  webServer: {
    command: "npm run dev",
    url: "http://localhost:5173",
    reuseExistingServer: true,
  },
});
```

---

## 3) “환경이 됐는지” 확인 실행 (1분)

테스트가 아직 없어도, 환경이 제대로면 아래 실행이 “실행은 되지만 테스트가 없다”로 끝납니다.

```bash
npm run e2e
```

UI 모드(권장):

```bash
npm run e2e:ui
```

---

## 자주 막히는 포인트(30초 트러블슈팅)

- **브라우저가 없다고 나올 때**: `npx playwright install`을 다시 실행
- **5173/3000 포트 충돌**: 이미 떠있는 프로세스가 있으면 종료 후 재시도
- **baseURL이 다를 때**: `playwright.config.ts`의 `baseURL`/`webServer.url` 확인
